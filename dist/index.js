"use strict";(()=>{var x=Object.defineProperty;var M=(s,t,n)=>t in s?x(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var u=(s,t,n)=>(M(s,typeof t!="symbol"?t+"":t,n),n);var a=(s,t,n)=>new Promise((o,i)=>{var r=l=>{try{h(n.next(l))}catch(p){i(p)}},d=l=>{try{h(n.throw(l))}catch(p){i(p)}},h=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,d);h((n=n.apply(s,t)).next())});function y(s){return new Promise(t=>{let n=document.querySelector(s);n&&t(n);let o=new MutationObserver(i=>{let r=document.querySelector(s);r&&(t(r),o.disconnect())});o.observe(document.body,{childList:!0,subtree:!0})})}function w(s,t=1){return c(`waiting for ${t} children on ${s}...`),new Promise(n=>{let o=document.querySelector(s);o&&o.childElementCount>=t&&n(o.childNodes);let i=new MutationObserver(r=>{let d=document.querySelectorAll(s);d.length>=t&&(console.log(`%c parentAll now has at least ${t} nodes...`,"color: lime",d),n(d),i.disconnect())});i.observe(document.body,{childList:!0,subtree:!0})})}function C(s){var n;window.prospectCue||(window.prospectCue={addressDivs:{},tagsAdded:[]});let t;for(let o of s)if(o.textContent&&o.textContent.trim()==="Street Address"){if(t=(n=o.closest(".pt-3 > div"))==null?void 0:n.children,!t){c("could not find addressDivChildren","red");return}let i={streetLabel:o,streetDiv:t[1],cityDiv:t[2],stateDiv:t[4],zipDiv:t[5],addressDivChildren:t};return window.prospectCue.addressDivs=i,i}}function c(s,t="lime",n){console.log(`%c ${s}`,`font-size: 15px; color: ${t}`,n)}function v(){return a(this,null,function*(){let s=yield w(".hl_contact-details-left .form-group .label",40),t=C(s);if(!t){c("no address divs found, returning from startAddButtons","red");return}c("address divs found... inserting map buttons","lime"),k(t)})}function k(s){return a(this,null,function*(){var l,p,L,A;if(document.querySelectorAll(".zg-map-btns").length>0){c("map buttons already present, returning","yellow");return}let t=document.createElement("div");t.id="mapLinks",t.className="mapContainerZG",t.style.display="inline-flex";let{streetLabel:n}=s;n.style.display="inline-flex",n.style.width="50%";let o={street:(l=s.streetDiv.querySelector("input"))==null?void 0:l.value,city:(p=s.cityDiv.querySelector("input"))==null?void 0:p.value,state:(L=s.stateDiv.querySelector("input"))==null?void 0:L.value,zip:(A=s.stateDiv.querySelector("input"))==null?void 0:A.value},i=encodeURIComponent(Object.values(o).filter(f=>f!==null).join(" ")),d=`<span class="zillowTitle">Search:</span><a href="https://www.google.com/search?q=${Object.values(o).filter(f=>f!==null).map(f=>encodeURIComponent(f)).join("+")}" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" class="zg-map-btns"></a>`,h=`<a href="https://www.zillow.com/homes/for_sale/${i}_rb" target="_blank" id="zillowLink"><img src="https://www.zillow.com/apple-touch-icon.png" class="zg-map-btns"></a>`;t.innerHTML=d+h,n.insertAdjacentElement("afterend",t)})}var m=class{constructor(t={}){u(this,"settings");u(this,"dialogSupported");u(this,"dialog");u(this,"elements");u(this,"focusable");u(this,"hasFormData");this.settings=Object.assign({accept:"OK",bodyClass:"dialog-open",cancel:"Cancel",dialogClass:"",message:"",soundAccept:"",soundOpen:"",template:""},t),this.init()}collectFormData(t){let n={};t.forEach((o,i)=>{typeof o=="string"&&(n.hasOwnProperty(i)?(Array.isArray(n[i])||(n[i]=[n[i]]),n[i].push(o)):n[i]=o)})}getFocusable(){var t;return[...(t=this.dialog)==null?void 0:t.querySelectorAll('button,[href],select,textarea,input:not([type="hidden"]),[tabindex]:not([tabindex="-1"])')]}init(){this.dialogSupported=typeof HTMLDialogElement=="function",this.dialog=document.createElement("dialog"),this.dialog.role="dialog",this.dialog.dataset.component=this.dialogSupported?"dialog":"no-dialog",this.dialog.innerHTML=`
    <form method="dialog" data-ref="form">
      <fieldset data-ref="fieldset" role="document">
        <legend data-ref="message" id="${Math.round(Date.now()).toString(36)}"></legend>
        <div data-ref="template"></div>
      </fieldset>
      <menu>
        <button${this.dialogSupported?"":' type="button"'} data-ref="cancel" value="cancel"></button>
        <button${this.dialogSupported?"":' type="button"'} data-ref="accept" value="default"></button>
      </menu>
      <audio data-ref="soundAccept"></audio>
      <audio data-ref="soundOpen"></audio>
    </form>`,document.body.appendChild(this.dialog),this.elements={},this.focusable=[],this.dialog.querySelectorAll("[data-ref]").forEach(t=>this.elements[t.dataset.ref]=t),this.dialog.setAttribute("aria-labelledby",this.elements.message.id),this.elements.cancel.addEventListener("click",()=>{this.dialog.dispatchEvent(new Event("cancel"))}),this.dialog.addEventListener("keydown",t=>{if(t.key==="Enter"&&(this.dialogSupported||t.preventDefault(),this.elements.accept.dispatchEvent(new Event("click"))),t.key==="Escape"&&this.dialog.dispatchEvent(new Event("cancel")),t.key==="Tab"){t.preventDefault();let n=this.focusable.length-1,o=this.focusable.indexOf(t.target);o=t.shiftKey?o-1:o+1,o<0&&(o=n),o>n&&(o=0),this.focusable[o].focus()}}),this.toggle()}open(t={}){let n=Object.assign({},this.settings,t);this.dialog.className=n.dialogClass||"",this.elements.accept.innerText=n.accept,this.elements.cancel.innerText=n.cancel,this.elements.cancel.hidden=n.cancel==="",this.elements.message.innerHTML=n.message,this.elements.soundAccept.src=n.soundAccept||"",this.elements.soundOpen.src=n.soundOpen||"",this.elements.target=n.target||"",this.elements.template.innerHTML=n.template||"",this.focusable=this.getFocusable(),this.hasFormData=this.elements.fieldset.elements.length>0,n.soundOpen&&this.elements.soundOpen.play(),this.toggle(!0),this.hasFormData?(this.focusable[0].focus(),this.focusable[0].select()):this.elements.accept.focus()}toggle(t=!1){this.dialogSupported&&t&&this.dialog.showModal(),this.dialogSupported||document.body.classList.toggle(this.settings.bodyClass,t),this.dialog.hidden=!t,this.elements.target&&!t&&this.elements.target.focus()}waitForUser(){return new Promise(t=>{this.dialog.addEventListener("cancel",()=>{this.toggle(),t(!1)},{once:!0}),this.elements.accept.addEventListener("click",()=>{let n=this.hasFormData?this.collectFormData(new FormData(this.elements.form)):!0;this.elements.soundAccept.getAttribute("src").length>0&&this.elements.soundAccept.play(),this.toggle(),t(n)},{once:!0})})}alert(t,n={target:e.target}){let o=Object.assign({},n,{cancel:"",message:t,template:""});return this.open(o),this.waitForUser()}confirm(t,n={target:e.target}){let o=Object.assign({},n,{message:t,template:""});return this.open(o),this.waitForUser()}prompt(t,n,o={target:e.target}){let i=`<label aria-label="${t}"><input type="text" name="prompt" value="${n}"></label>`,r=Object.assign({},o,{message:t,template:i});return this.open(r),this.waitForUser()}};function b(){return a(this,null,function*(){console.log("%c inserting tag link and tag alert...","font-size:15px; color:lime;"),window.prospectCue||(window.prospectCue={addressDivs:{},tagsAdded:[]}),window.prospectCue.tagsAdded=[];let s=yield w(".hl_contact-details-left .h-full .bg-gray-100 [data-v-56639245]",3),t=null;for(let o=0;o<s.length;o++){let i=s[o];if(i.textContent&&i.textContent.trim()==="Tags"){t=i.parentElement,console.log("original tagDiv found -> ",t);break}}if(t===null){c("Prospect Cue: tag div not found","pink");return}if(t.querySelector(".tags-edit-container"))return;let n=yield T(t);if(!n){console.error("Prospect Cue: new tag div not found");return}console.log(`new tag div found -> ${n}`),g(n)})}function T(s){return a(this,null,function*(){if(s.querySelector("tags-edit"))return null;let t=s.lastElementChild,n=document.createElement("div");n.classList.add("tags-edit-container");let o=document.createElement("a"),i=window.location.href;return o.href=i.replace(/contacts.*/,"settings/tags"),o.target="_blank",o.innerHTML=`<span class="tags-edit">Edit Tags  <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
  width="12" height="12"
  viewBox="0 0 172 172"
  style=" fill:#000000;"><g transform=""><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><g><path d="M5.375,26.875h118.25v118.25h-118.25z" fill="#c2e8ff"></path><path d="M118.25,32.25v107.5h-107.5v-107.5h107.5M129,21.5h-129v129h129v-129z" fill="#357ded"></path><path d="M129,43v32.25h-21.5l0,-32.25z" fill="#c2e8ff"></path><path d="M118.25,21.5v21.5h-32.25v-21.5z" fill="#c2e8ff"></path><g fill="#357ded"><path d="M150.5,0h-64.5l21.5,21.5l-43,43l21.5,21.5l43,-43l21.5,21.5z"></path></g></g><path d="" fill="none"></path><path d="" fill="none"></path></g></g></svg>
  </span>`,n.prepend(o),s.insertBefore(n,t),s})}function g(s){return a(this,null,function*(){if(!s){console.log("%c no new tag div passed, must be on conversations or opportunities page, now waiting for add new section","font-size:15px; color:lime;");let n=yield y(".add-new");return E(n)}let t=document.querySelector(".add-new");if(t)return console.log("%c add new section found immediately, attaching tag alert","font-size:15px; color:lime;"),E(t);console.log("%c no add new tag section present, attaching click listener on new tag div -> ","font-size: 15px; color: lime",s),s.addEventListener("click",n=>a(this,null,function*(){let o=document.querySelector(".add-new");if(!o){console.log("click occurred on tag div, but add new not present",o);return}console.log("click occured on tag div, addNew found",o);let i=yield y(".add-new");console.log("add new section loaded -> ",i),E(i)}))})}function E(s){if(window.prospectCue||(window.prospectCue={tagsAdded:[],addressDivs:{}}),window.prospectCue.tagsAdded=[],console.log("now attaching tag alert..."),s.hasAttribute("listener"))return console.log("tag alert found, returning...");s.setAttribute("listener","tagAlert"),s.addEventListener("click",function(n){s.removeAttribute("listener"),D(n)},{capture:!0,once:!0})}function D(s){return a(this,null,function*(){console.log("add new tag click captured",s),s.stopPropagation();let t=s.target,n=t.textContent,o=new m;o.open({dialogClass:"tag-confirm-dialog",accept:"Yes",cancel:"No",message:`Are you sure you want to add <span class="tag-add">${t.textContent}</span> as a new tag?</div>`,target:t});let i=yield o.waitForUser();console.log(`user wanted to add new tag? --> ${i}`),i&&(window.prospectCue.tagsAdded.push(t.textContent),t.click()),setTimeout(g,100)})}(function(){return a(this,null,function*(){yield z()})})();function z(){return a(this,null,function*(){console.group("%c Zillow & Google Buttons","font-size:20px; color:lime;"),window.location.pathname.includes("/contacts/detail/")&&(window.prospectCue={addressDivs:{},tagsAdded:[]},console.log("%c window reloaded on contact page",window.location.pathname,"font-size:15px; color:lime;"),yield v(),yield b()),window.location.pathname.includes("conversations")&&(console.log("reloaded to conversations page, checking for add new tag"),yield g()),window.location.pathname.includes("/opportunities/list")&&(console.log("reloaded to opportunities list page, checking for add new tag"),yield g()),window.addEventListener("click",function(t){let n=window.location.pathname;console.log("window click recorded",t),setTimeout(()=>a(this,null,function*(){console.log(`current URL -> pathname 500ms later... = ${n} -> ${window.location.pathname}`);let o=t.target;o.href&&o.href.includes("/contacts/detail/")?(yield v(),yield b()):!n.includes("/contacts/detail/")&&window.location.pathname.includes("/contacts/detail/")?(yield v(),yield b()):window.location.pathname.includes("/conversations/conversations")?yield g():n.includes("/opportunities/list")&&window.location.pathname.includes("/opportunities/list")&&(yield g())}),500)},!0)})}})();
//# sourceMappingURL=index.js.map
