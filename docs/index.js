"use strict";var prospectcue=(()=>{var E=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var R=(o,t,n)=>t in o?E(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var L=(o,t)=>{for(var n in t)E(o,n,{get:t[n],enumerable:!0})},V=(o,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of I(t))!U.call(o,a)&&a!==n&&E(o,a,{get:()=>t[a],enumerable:!(i=j(t,a))||i.enumerable});return o};var W=o=>V(E({},"__esModule",{value:!0}),o);var m=(o,t,n)=>(R(o,typeof t!="symbol"?t+"":t,n),n);var c=(o,t,n)=>new Promise((i,a)=>{var l=r=>{try{d(n.next(r))}catch(f){a(f)}},u=r=>{try{d(n.throw(r))}catch(f){a(f)}},d=r=>r.done?i(r.value):Promise.resolve(r.value).then(l,u);d((n=n.apply(o,t)).next())});var J={};L(J,{addTagElements:()=>y,checkAddNewTag:()=>p,colorConsole:()=>s,constants:()=>S,insertTagLink:()=>O,startAddButtons:()=>v,startProspectCueCustomizations:()=>B,utils:()=>k,wait:()=>x});var k={};L(k,{colorConsole:()=>s,getAddressDivs:()=>A,openAllContactDivs:()=>D,sectionTriggers:()=>C,toggleSectionTriggers:()=>K});var S={};L(S,{ACTIONS_DIVS_SELECTOR:()=>w,CONTACT_DIVS_SELECTOR:()=>M});var M=".hl_contact-details-left > div > .h-full.overflow-y-auto > .py-3.px-3",w=".hl_contact-details-left > div > .h-full.overflow-y-auto > .bg-gray-100 > .py-3.px-3";var x={};L(x,{waitForElement:()=>T,waitForManyElements:()=>g,waitForTextContent:()=>G});var P=o=>o.selector!==void 0;function T(o){return new Promise(t=>{let n=P(o)?document.querySelector(o.selector):o.element;n&&t(n);let i=new MutationObserver(a=>{let l=P(o)?document.querySelector(o.selector):o.element;l&&(t(l),i.disconnect())});i.observe(document.body,{childList:!0,subtree:!0})})}function g(o,t=1,n){return s(`waiting for ${t} children on ${o} ${n?`with textContent ${n}`:""}`),new Promise(i=>{let a=document.querySelectorAll(o);a.length>=t&&(s(`${o} already has at least ${t} nodes...`,"green",a),i(a));let l=new MutationObserver(u=>{let d=document.querySelectorAll(o);d.length>=t&&(s(`${o} now has at least ${t} nodes...`,"green",d),i(d),l.disconnect())});l.observe(document.body,{childList:!0,subtree:!0})})}function G(o,t){return new Promise(n=>{let i=document.querySelectorAll(o);for(let l=0;l<i.length;l++){let u=i[l];u.textContent===t&&(s(`found textContent immediately: ${t}...`,"green",u),n(u))}let a=new MutationObserver(l=>{let u=document.querySelectorAll(o);for(let d=0;d<u.length;d++){let r=u[d];r.textContent===t&&(s(`found textContent: ${t}...`,"green",r),n(r),a.disconnect())}});a.observe(document.body,{childList:!0,subtree:!0})})}function A(o){var n;window.prospectCue||(window.prospectCue={addressDivs:{},tagsAdded:[],contactLabels:[],searchBox:null});let t;for(let i of o)if(i.textContent&&i.textContent.trim()==="Street Address"){if(t=(n=i.closest(".pt-3 > div"))==null?void 0:n.children,!t){s("could not find addressDivChildren","red");return}let a={streetLabel:i,streetDiv:t[1],cityDiv:t[2],stateDiv:t[4],zipDiv:t[5],addressDivChildren:t};return window.prospectCue.addressDivs=a,a}}var C=[];function D(){return c(this,null,function*(){let o=yield g(M,3),t=yield g(w,3),n="M9 5l7 7-7 7";for(let i of o){let a=i.querySelector("svg > path");a&&(C.push(i),a.getAttribute("d")===n&&(s("opening contact div","green",i),i.firstChild.click()))}for(let i of t){if(!i.childElementCount)continue;C.push(i),i.querySelectorAll("svg > path")[1].getAttribute("d")===n&&(s("opening actions div","green",i),i.firstChild.click())}})}function K(){for(let o of C)o.firstChild.click()}function s(o,t,n){let i={red:"#f1889a",green:"#6DECB9",blue:"#88FFF7",yellow:"#FFF6BF",orange:"#f19684"};t!=null||(t="blue"),console.log(`%c \u{1FA90} ${o}`,`font-size: 13px; color: ${i[t]} `,n)}function v(){return c(this,null,function*(){yield D();let o=yield g(".hl_contact-details-left .form-group .label",40),t=A(o);if(!t){s("no address divs found, returning from startAddButtons","red");return}s("address divs found... inserting map buttons","green"),yield Y(t)})}function Y(o){return c(this,null,function*(){var r,f,F,z,$,q,_,N;if(document.querySelectorAll(".zg-map-btns").length>0){s("map buttons already present, returning","yellow");return}let t=document.createElement("div");t.id="mapLinks",t.className="mapContainerZG",t.style.display="inline-flex";let{streetLabel:n}=o;n.style.display="inline-flex",n.style.width="50%";let i={street:(f=(r=o.streetDiv.querySelector("input"))==null?void 0:r.value)!=null?f:null,city:(z=(F=o.cityDiv.querySelector("input"))==null?void 0:F.value)!=null?z:null,state:(q=($=o.stateDiv.querySelector("input"))==null?void 0:$.value)!=null?q:null,zip:(N=(_=o.stateDiv.querySelector("input"))==null?void 0:_.value)!=null?N:null},a=encodeURIComponent(Object.values(i).filter(h=>h!==null).join(" ")),u=`<span class="zillowTitle">Search:</span><a href="https://www.google.com/search?q=${Object.values(i).filter(h=>h!==null).map(h=>encodeURIComponent(h)).join("+")}" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" class="zg-map-btns"></a>`,d=`<a href="https://www.zillow.com/homes/for_sale/${a}_rb" target="_blank" id="zillowLink"><img src="https://www.zillow.com/apple-touch-icon.png" class="zg-map-btns"></a>`;t.innerHTML=u+d,n.insertAdjacentElement("afterend",t)})}var b=class{constructor(t={}){m(this,"settings");m(this,"dialogSupported");m(this,"dialog");m(this,"elements");m(this,"focusable");m(this,"hasFormData");this.settings=Object.assign({accept:"OK",bodyClass:"dialog-open",cancel:"Cancel",dialogClass:"",message:"",soundAccept:"",soundOpen:"",template:""},t),this.init()}collectFormData(t){let n={};t.forEach((i,a)=>{typeof i=="string"&&(n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(i)):n[a]=i)})}getFocusable(){var t;return[...(t=this.dialog)==null?void 0:t.querySelectorAll('button,[href],select,textarea,input:not([type="hidden"]),[tabindex]:not([tabindex="-1"])')]}init(){this.dialogSupported=typeof HTMLDialogElement=="function",this.dialog=document.createElement("dialog"),this.dialog.role="dialog",this.dialog.dataset.component=this.dialogSupported?"dialog":"no-dialog",this.dialog.innerHTML=`
    <form method="dialog" data-ref="form">
      <fieldset data-ref="fieldset" role="document">
        <legend data-ref="message" id="${Math.round(Date.now()).toString(36)}"></legend>
        <div data-ref="template"></div>
      </fieldset>
      <menu>
        <button${this.dialogSupported?"":' type="button"'} data-ref="cancel" value="cancel"></button>
        <button${this.dialogSupported?"":' type="button"'} data-ref="accept" value="default"></button>
      </menu>
      <audio data-ref="soundAccept"></audio>
      <audio data-ref="soundOpen"></audio>
    </form>`,document.body.appendChild(this.dialog),this.elements={},this.focusable=[],this.dialog.querySelectorAll("[data-ref]").forEach(t=>this.elements[t.dataset.ref]=t),this.dialog.setAttribute("aria-labelledby",this.elements.message.id),this.elements.cancel.addEventListener("click",()=>{this.dialog.dispatchEvent(new Event("cancel"))}),this.dialog.addEventListener("keydown",t=>{if(t.key==="Enter"&&(this.dialogSupported||t.preventDefault(),this.elements.accept.dispatchEvent(new Event("click"))),t.key==="Escape"&&this.dialog.dispatchEvent(new Event("cancel")),t.key==="Tab"){t.preventDefault();let n=this.focusable.length-1,i=this.focusable.indexOf(t.target);i=t.shiftKey?i-1:i+1,i<0&&(i=n),i>n&&(i=0),this.focusable[i].focus()}}),this.toggle()}open(t={}){let n=Object.assign({},this.settings,t);this.dialog.className=n.dialogClass||"",this.elements.accept.innerText=n.accept,this.elements.cancel.innerText=n.cancel,this.elements.cancel.hidden=n.cancel==="",this.elements.message.innerHTML=n.message,this.elements.soundAccept.src=n.soundAccept||"",this.elements.soundOpen.src=n.soundOpen||"",this.elements.target=n.target||"",this.elements.template.innerHTML=n.template||"",this.focusable=this.getFocusable(),this.hasFormData=this.elements.fieldset.elements.length>0,n.soundOpen&&this.elements.soundOpen.play(),this.toggle(!0),this.hasFormData?(this.focusable[0].focus(),this.focusable[0].select()):this.elements.accept.focus()}toggle(t=!1){this.dialogSupported&&t&&this.dialog.showModal(),this.dialogSupported||document.body.classList.toggle(this.settings.bodyClass,t),this.dialog.hidden=!t,this.elements.target&&!t&&this.elements.target.focus()}waitForUser(){return new Promise(t=>{this.dialog.addEventListener("cancel",()=>{this.toggle(),t(!1)},{once:!0}),this.elements.accept.addEventListener("click",()=>{let n=this.hasFormData?this.collectFormData(new FormData(this.elements.form)):!0;this.elements.soundAccept.getAttribute("src").length>0&&this.elements.soundAccept.play(),this.toggle(),t(n)},{once:!0})})}alert(t,n={target:e.target}){let i=Object.assign({},n,{cancel:"",message:t,template:""});return this.open(i),this.waitForUser()}confirm(t,n={target:e.target}){let i=Object.assign({},n,{message:t,template:""});return this.open(i),this.waitForUser()}prompt(t,n,i={target:e.target}){let a=`<label aria-label="${t}"><input type="text" name="prompt" value="${n}"></label>`,l=Object.assign({},i,{message:t,template:a});return this.open(l),this.waitForUser()}};function y(){return c(this,null,function*(){s("inserting tag link and tag alert...","blue"),window.prospectCue||(window.prospectCue={addressDivs:{},tagsAdded:[],contactLabels:[],searchBox:null}),window.prospectCue.tagsAdded=[];let o=yield g(w,3),t=null;for(let i=0;i<o.length;i++){let a=o[i],l=a.querySelector("span.text-sm.font-medium");if(l!=null&&l.textContent&&l.textContent.trim()==="Tags"){t=a,s("original tagDiv found -> ","orange",t);break}}if(t===null){s("tag div not found","red");return}if(t.querySelector(".tags-edit-container"))return;let n=yield O(t);if(!n){s("new tag div not found","red");return}s("new tag div found -> ","green",n),p(n)})}function O(o){return c(this,null,function*(){if(o.querySelector("tags-edit"))return null;let t=o.lastElementChild,n=document.createElement("div");n.classList.add("tags-edit-container");let i=document.createElement("a"),a=window.location.href;return i.href=a.replace(/contacts.*/,"settings/tags"),i.target="_blank",i.innerHTML=`<span class="tags-edit">Edit Tags  <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
  width="12" height="12"
  viewBox="0 0 172 172"
  style=" fill:#000000;"><g transform=""><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><path d="" fill="none"></path><g><path d="M5.375,26.875h118.25v118.25h-118.25z" fill="#c2e8ff"></path><path d="M118.25,32.25v107.5h-107.5v-107.5h107.5M129,21.5h-129v129h129v-129z" fill="#357ded"></path><path d="M129,43v32.25h-21.5l0,-32.25z" fill="#c2e8ff"></path><path d="M118.25,21.5v21.5h-32.25v-21.5z" fill="#c2e8ff"></path><g fill="#357ded"><path d="M150.5,0h-64.5l21.5,21.5l-43,43l21.5,21.5l43,-43l21.5,21.5z"></path></g></g><path d="" fill="none"></path><path d="" fill="none"></path></g></g></svg>
  </span>`,n.appendChild(i),o.insertBefore(n,t),o})}function p(o){return c(this,null,function*(){if(!o){s("new tag div not found, waiting for click","orange");let n=yield T({selector:".add-new"});return H(n)}let t=document.querySelector(".add-new");if(t)return s("add new section found","orange"),H(t);s("add new section not found, waiting for click","orange",o),o.addEventListener("click",n=>c(this,null,function*(){let i=document.querySelector(".add-new");if(!i){s("click occurred on tag div, but add new not present","red");return}s("click occured on tag div, addNew found","green",i);let a=yield T({selector:".add-new"});s("add new section loaded -> ","green",a),H(a)}))})}function H(o){if(window.prospectCue||(window.prospectCue={tagsAdded:[],addressDivs:{},contactLabels:[],searchBox:null}),window.prospectCue.tagsAdded=[],s("now attaching tag alert..."),o.hasAttribute("listener"))return s("tag alert found, returning...");o.setAttribute("listener","tagAlert"),o.addEventListener("click",function(n){o.removeAttribute("listener"),Z(n)},{capture:!0,once:!0})}function Z(o){return c(this,null,function*(){var l;s("add new tag click captured","green",o),o.stopPropagation();let t=o.target,n=(l=t.innerText)==null?void 0:l.trim(),i=new b;i.open({dialogClass:"tag-confirm-dialog",accept:"Yes",cancel:"No",message:`Are you sure you want to add <span class="tag-add">${n}</span> as a new tag?</div>`,target:t});let a=yield i.waitForUser();s(`tag add confirmation: ${a} for tag ${n}`,"green"),a&&(window.prospectCue.tagsAdded.push(n),t.click()),setTimeout(p,100)})}s("Starting prospectcue customizations","green");B();function B(){return c(this,null,function*(){s("Starting prospect cue customizations","green"),window.location.pathname.includes("/contacts/detail/")&&(window.prospectCue={addressDivs:{},tagsAdded:[],contactLabels:[],searchBox:null},s("reloaded to contacts detail page, starting to add zillow/google buttons","yellow"),yield v(),yield y()),window.location.pathname.includes("conversations")&&(s("reloaded to conversations page, checking for add new tag","yellow"),yield p()),window.location.pathname.includes("/opportunities/list")&&(s("reloaded to opportunities list page, checking for add new tag","yellow"),yield p()),window.addEventListener("click",function(t){let n=window.location.pathname;setTimeout(()=>c(this,null,function*(){s(`current URL -> pathname 500ms later... = ${n} -> ${window.location.pathname}`,"yellow");let i=t.target;i.href&&i.href.includes("/contacts/detail/")?(yield v(),yield y()):!n.includes("/contacts/detail/")&&window.location.pathname.includes("/contacts/detail/")?(yield v(),yield y()):window.location.pathname.includes("/conversations/conversations")?yield p():n.includes("/opportunities/list")&&window.location.pathname.includes("/opportunities/list")&&(yield p())}),500)},!0)})}return W(J);})();
//# sourceMappingURL=index.js.map
